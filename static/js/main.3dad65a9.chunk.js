(this["webpackJsonpwapp-clone"]=this["webpackJsonpwapp-clone"]||[]).push([[0],{70:function(e,t,c){},71:function(e,t,c){},72:function(e,t,c){},86:function(e,t,c){},87:function(e,t,c){},88:function(e,t,c){},89:function(e,t,c){"use strict";c.r(t);var a=c(2),n=c.n(a),s=c(30),i=c.n(s),r=(c(70),c(12)),o=(c(71),c(105)),j=c(103),d=(c(72),c(44)),l=c.n(d),b=c(56),h=c.n(b),u=c(45),O=c.n(u),m=c(57),p=c.n(m),x=c(58),f=c.n(x),v=c(10),g=c(33),N=g.a.initializeApp({apiKey:"AIzaSyDyCh650E6JyWQyjXpUAcpxKk2MqQN-fq4",authDomain:"wapp-clone-816fc.firebaseapp.com",projectId:"wapp-clone-816fc",storageBucket:"wapp-clone-816fc.appspot.com",messagingSenderId:"93442793908",appId:"1:93442793908:web:5be157f01cd84d24ec92e1",measurementId:"G-LM8BXPGNW9"}).firestore(),S=g.a.auth(),y=new g.a.auth.GoogleAuthProvider,w=N,C=c(4),_=Object(a.createContext)(),I=function(e){var t=e.reducer,c=e.initialState,n=e.children;return Object(C.jsx)(_.Provider,{value:Object(a.useReducer)(t,c),children:n})},k=function(){return Object(a.useContext)(_)};var E=function(){var e,t,c=Object(a.useState)(""),n=Object(r.a)(c,2),s=n[0],i=n[1],d=Object(a.useState)(""),b=Object(r.a)(d,2),u=b[0],m=b[1],x=Object(v.f)().roomId,N=Object(a.useState)(""),S=Object(r.a)(N,2),y=S[0],_=S[1],I=Object(a.useState)([]),E=Object(r.a)(I,2),A=E[0],D=E[1],M=k(),P=Object(r.a)(M,2),T=P[0].user;return P[1],Object(a.useEffect)((function(){x&&(w.collection("rooms").doc(x).onSnapshot((function(e){return _(e.data().name)})),w.collection("rooms").doc(x).collection("messages").orderBy("timestamp","asc").onSnapshot((function(e){return D(e.docs.map((function(e){return e.data()})))})))}),[x]),Object(a.useEffect)((function(){i(Math.floor(5e3*Math.random()))}),[x]),Object(C.jsxs)("div",{className:"chat",children:[Object(C.jsxs)("div",{className:"chat_header",children:[Object(C.jsx)(o.a,{src:"https://avatars.dicebear.com/api/human/".concat(s,".svg")}),Object(C.jsxs)("div",{className:"chat_headerInfo",children:[Object(C.jsx)("h3",{children:y}),Object(C.jsxs)("p",{children:["last seen"," ",new Date(null===(e=A[A.length-1])||void 0===e||null===(t=e.timestamp)||void 0===t?void 0:t.toDate()).toUTCString()]})]}),Object(C.jsxs)("div",{className:"chat_headerRight",children:[Object(C.jsx)(j.a,{children:Object(C.jsx)(l.a,{})}),Object(C.jsx)(j.a,{children:Object(C.jsx)(h.a,{})}),Object(C.jsx)(j.a,{children:Object(C.jsx)(O.a,{})})]})]}),Object(C.jsx)("div",{className:"chat_body",children:A.map((function(e){var t;return Object(C.jsxs)("p",{className:"chat_message ".concat(e.name===T.displayName&&"chat_receiver"," "),children:[Object(C.jsx)("span",{className:"chat_name",children:e.name}),e.message,Object(C.jsx)("span",{className:"chat_timestamp",children:new Date(null===(t=e.timestamp)||void 0===t?void 0:t.toDate()).toUTCString()})]})}))}),Object(C.jsxs)("div",{className:"chat_footer",children:[Object(C.jsx)(j.a,{children:Object(C.jsx)(p.a,{})}),Object(C.jsxs)("form",{children:[Object(C.jsx)("input",{value:u,onChange:function(e){return m(e.target.value)},type:"text",placeholder:"Type a message"}),Object(C.jsx)("button",{onClick:function(e){e.preventDefault(),console.log("You typed >>>>>>",u),w.collection("rooms").doc(x).collection("messages").add({message:u,name:T.displayName,timestamp:g.a.firestore.FieldValue.serverTimestamp()}),m("")},type:"submit",children:"Send a message"})]}),Object(C.jsx)(j.a,{children:Object(C.jsx)(f.a,{})})]})]})},A=(c(86),c(59)),D=c.n(A),M=c(60),P=c.n(M),T=(c(87),c(36));var B=function(e){var t,c=e.id,n=e.name,s=e.addNewChat,i=Object(a.useState)(""),j=Object(r.a)(i,2),d=j[0],l=j[1],b=Object(a.useState)(""),h=Object(r.a)(b,2),u=h[0],O=h[1];return Object(a.useEffect)((function(){c&&w.collection("rooms").doc(c).collection("messages").orderBy("timestamp","desc").onSnapshot((function(e){return O(e.docs.map((function(e){return e.data()})))}))}),[c]),Object(a.useEffect)((function(){l(Math.floor(5e3*Math.random()))}),[]),s?Object(C.jsx)("div",{onClick:function(){var e=prompt("Please enter name for chat room");e&&w.collection("rooms").add({name:e})},className:"sidebarChat",children:Object(C.jsx)("h2",{children:"Add new Chat"})}):Object(C.jsx)(T.b,{to:"/rooms/".concat(c),children:Object(C.jsxs)("div",{className:"sidebarChat",children:[Object(C.jsx)(o.a,{src:"https://avatars.dicebear.com/api/human/".concat(d,".svg")}),Object(C.jsxs)("div",{className:"sidebarChat_info",children:[Object(C.jsx)("h2",{children:n}),Object(C.jsx)("p",{children:null===(t=u[0])||void 0===t?void 0:t.message})]})]})})};var W=function(){var e=Object(a.useState)([]),t=Object(r.a)(e,2),c=t[0],n=t[1],s=k(),i=Object(r.a)(s,2),d=i[0].user;return i[1],Object(a.useEffect)((function(){var e=w.collection("rooms").onSnapshot((function(e){return n(e.docs.map((function(e){return{id:e.id,data:e.data()}})))}));return function(){e()}}),[]),Object(C.jsxs)("div",{className:"sidebar",children:[Object(C.jsxs)("div",{className:"sidebar_header",children:[Object(C.jsx)(o.a,{src:null===d||void 0===d?void 0:d.photoURL}),Object(C.jsxs)("div",{className:"sidebar_headerRight",children:[Object(C.jsx)(j.a,{children:Object(C.jsx)(D.a,{})}),Object(C.jsx)(j.a,{children:Object(C.jsx)(P.a,{})}),Object(C.jsx)(j.a,{children:Object(C.jsx)(O.a,{})})]})]}),Object(C.jsx)("div",{className:"sidebar_search",children:Object(C.jsxs)("div",{className:"sidebar_searchContainer",children:[Object(C.jsx)(l.a,{}),Object(C.jsx)("input",{type:"text",placeholder:"Search or start a new chat"})]})}),Object(C.jsxs)("div",{className:"sidebar_chats",children:[Object(C.jsx)(B,{addNewChat:!0}),c.map((function(e){return Object(C.jsx)(B,{id:e.id,name:e.data.name},e.id)}))]})]})},F=c(61),R=(c(88),c(104)),U=c(51),G="SET_USER",L=function(e,t){switch(t.type){case G:return Object(U.a)(Object(U.a)({},e),{},{user:t.user});default:return e}};var J=function(){var e=k(),t=Object(r.a)(e,2);Object(F.a)(t[0]);var c=t[1];return Object(C.jsx)("div",{className:"login",children:Object(C.jsxs)("div",{className:"login_container",children:[Object(C.jsx)("img",{src:"https://upload.wikimedia.org/wikipedia/commons/thumb/6/6b/WhatsApp.svg/598px-WhatsApp.svg.png",alt:""}),Object(C.jsx)("div",{className:"login_text",children:Object(C.jsx)("h1",{children:"Sign in to WhatsApp"})}),Object(C.jsx)(R.a,{variant:"contained",type:"submit",onClick:function(){S.signInWithPopup(y).then((function(e){c({type:G,user:e.user})})).catch((function(e){return alert(e.message)}))},children:"Sign in with Google"})]})})};var q=function(){var e=k(),t=Object(r.a)(e,2),c=t[0].user;return t[1],Object(C.jsx)("div",{className:"app",children:c?Object(C.jsx)("div",{className:"app_body",children:Object(C.jsxs)(T.a,{children:[Object(C.jsx)(W,{}),Object(C.jsxs)(v.c,{children:[Object(C.jsx)(v.a,{path:"/rooms/:roomId",children:Object(C.jsx)(E,{})}),Object(C.jsx)(v.a,{path:"/",children:Object(C.jsx)(E,{})})]})]})}):Object(C.jsx)(J,{})})},z=function(e){e&&e instanceof Function&&c.e(3).then(c.bind(null,106)).then((function(t){var c=t.getCLS,a=t.getFID,n=t.getFCP,s=t.getLCP,i=t.getTTFB;c(e),a(e),n(e),s(e),i(e)}))};i.a.render(Object(C.jsx)(n.a.StrictMode,{children:Object(C.jsx)(I,{initialState:{user:null},reducer:L,children:Object(C.jsx)(q,{})})}),document.getElementById("root")),z()}},[[89,1,2]]]);
//# sourceMappingURL=main.3dad65a9.chunk.js.map